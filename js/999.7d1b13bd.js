"use strict";(self["webpackChunkcrosses"]=self["webpackChunkcrosses"]||[]).push([[999],{5999:function(e,t,o){o.r(t),o.d(t,{default:function(){return S}});var r=o(3396),a=o(4870),l=o(7139),s=o(9242),n=o(65);function c(){const e=(0,n.oR)(),t=(0,r.Fl)((()=>e.getters["getSettings"])).value;return{settings:t}}var i=o(2483);function g(){const e=(0,n.oR)(),t=(0,i.yj)(),o=t.query.debug,a=()=>(0,r.Fl)((()=>e.getters["debug/allowMoverPopup"])).value,l=t=>{e.dispatch("debug/allowMoverPopup",t)},s=(0,r.Fl)((()=>e.getters["debug/dontPassMoveToComputer"])).value,c=t=>{e.dispatch("debug/dontPassMoveToComputer",t)};return{debugMode:o,getAllowMoverPopup:a,allowMoverPopup:l,getDontPassMoveToComputer:s,dontPassMoveToComputer:c}}o(7658);function u(){const e=(0,n.oR)(),{settings:t}=c(),{debugMode:o}=g(),l=document.documentElement;l.style.setProperty("--matrix-range",t.range);const s=()=>{const t=(0,r.Fl)((()=>e.getters["getMatrix"])).value;return t[0].map(((e,o)=>t.map((e=>e[o]))))},i=()=>{const t=(0,r.Fl)((()=>e.getters["getMatrix"])).value;return t.map((e=>e.slice().reverse()))},u=({mover:o,direction:a="horizontal"})=>{const l=(0,r.Fl)((()=>e.getters["getMatrix"])).value,n="vertical"===a?s():l,c="player"===o?t.playerMark:t.computerMark,i=n.map((e=>e.filter((e=>e===c)).length===t.range));if(i.some((e=>e)))return!0},m=({mover:o,direction:a="toBottom"})=>{const l=(0,r.Fl)((()=>e.getters["getMatrix"])).value,s="toTop"===a?i():l,n="player"===o?t.playerMark:t.computerMark;let c=[];if(s.forEach(((e,t)=>{e.forEach(((e,o)=>{t===o&&e===n&&c.push(!0)}))})),c.length===t.range)return!0},d=()=>{const o=(0,a.qj)(Array(t.range).fill().map((()=>Array(t.range).fill())));e.dispatch("setMatrix",o)},p=()=>(0,r.Fl)((()=>e.getters["getMatrix"])).value,v=({mark:t,coords:o})=>{e.dispatch("markCell",{mark:t,coords:o})},M=({x:t,y:a})=>{o&&console.log("[debug] matrix():checkCell coords:",{x:t,y:a});const l=(0,r.Fl)((()=>e.getters["getMatrix"])).value;return o&&console.log("[debug] matrix():checkCell matrix[x][y]:",l[t][a]),!l[t][a]};return{setMatrix:d,getMatrix:p,markCell:v,testMatrixAxis:u,testMatrixDiagonal:m,checkMatrixCell:M}}function m(){const e=(0,n.oR)(),{settings:t}=c(),o=u(),a=g(),l=a.debugMode,s=(0,r.Fl)((()=>a.getDontPassMoveToComputer)).value,i=e=>o.testMatrixAxis({mover:e})?{victory:!0,message:"Победа по горизонтали"}:o.testMatrixAxis({mover:e,direction:"vertical"})?{victory:!0,message:"Победа по вертикали"}:o.testMatrixDiagonal({mover:e})||o.testMatrixDiagonal({mover:e,direction:"toTop"})?{victory:!0,message:"Победа по диагонали"}:{victory:!1,message:null};o.setMatrix();const m=()=>(0,r.Fl)((()=>e.getters["getCurrentMove"])).value,d=t=>{e.dispatch("changeMove",t)},p=({mover:r,coords:a})=>{l&&console.log("[debug] gameplay:setMark() | Ставит маркер:",r),o.markCell({mark:"player"===r?t.playerMark:t.computerMark,coords:a});const n=i(r);if(n.victory)return k({winner:r,message:n.message}),void(l&&console.log("[debug] gameplay:setMark | Условие победы: ",n.message));l&&"player"===r&&s||e.dispatch("changeMove","player"===r?"computer":"player")},v=()=>{let t=0;const o=(0,r.Fl)((()=>e.getters["getMatrix"])).value;return o.map((e=>{e.map((e=>{e||t++}))})),t>0},M=()=>{if(l){const t=(0,r.Fl)((()=>e.getters["getMatrix"])).value;console.log("[debug] Победитель: Ничья"),console.log("[debug] matrix:",t)}e.dispatch("setDraw"),x()},k=t=>{if(l){const o=(0,r.Fl)((()=>e.getters["getMatrix"])).value;console.log(`[debug] Победитель: ${t.mover}`),console.log("[debug] matrix:",o)}e.dispatch("setVictory",t),x()},y=()=>{l&&console.log("[debug] gameplay:resetGame()"),o.setMatrix(),e.dispatch("clearCurrentGameStat")},x=()=>{const t=(0,r.Fl)((()=>e.getters["getGameState"])).value;l&&console.log("[debug] gameplay:newGame() gameState:",t),t?(alert(`\n        Игра окончена! \n\n        ${"Ничья"===t?"Ничья":`Победитель: ${t.winner}`}\n      `),y()):l&&console.log("[debug] Ошибка: игра продолжается")};return{getCurrentMove:m,changeMove:d,setMark:p,checkFreeMovies:v,declareDraw:M,declareWinner:k,resetGame:y}}function d(){const{settings:e}=c(),t=u(),o=m(),r=()=>{let t=0+Math.random()*(e.range-0);return Math.floor(t)},a=()=>{o.checkFreeMovies()?setTimeout((()=>{if(0===e.difficulty){let e=r(),l=r();const s=t.checkMatrixCell({x:e,y:l});s?o.setMark({mover:"computer",coords:{x:e,y:l}}):a()}}),500):o.declareDraw()};return{computerMove:a}}const p={class:"game-area"},v={class:"game-area__grid"},M=["disabled","onClick"],k={key:0,class:"game-area__cell-popup"},y=["onClick"],x=["onClick"],b={key:0,class:"game-area__debug-actions-panel"};var h={__name:"GameArea",setup(e){const{settings:t}=c(),{getMatrix:o}=u(),{computerMove:n}=d(),i=m(),h=g(),_=h.debugMode;let f=(0,a.iH)(!1),w=(0,a.iH)(0),C=(0,a.iH)(0),F=(0,r.Fl)((()=>h.getAllowMoverPopup())),S=(0,r.Fl)((()=>o())),D=(0,r.Fl)((()=>i.getCurrentMove()));(0,r.YP)(D,((e,t)=>{e!==t&&"computer"===e&&n()})),i.changeMove(t.firstMove);const P=(e,t)=>{i.setMark({mover:"player",coords:{x:e,y:t}})},U=(e,t)=>{console.log("[debug] db__fShowCellPopup method | x:",e),console.log("[debug] db__fShowCellPopup method | y:",t),w.value=e,C.value=t,f.value=!0},A=({coords:e,mover:o})=>{console.log("[debug] db__onMark method | mover:",o),console.log("[debug] db__onMark method | settings.computerMark:",t.computerMark),f.value=!1,i.setMark({mover:o,coords:e})},G=()=>{h.allowMoverPopup(!F.value)},T=()=>{console.log("[debug] Сброс игры"),i.resetGame()};return(e,t)=>((0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("section",v,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,a.SU)(S),((e,t)=>((0,r.wg)(),(0,r.iD)(r.HY,{key:`row-${t}`},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e,((e,o)=>((0,r.wg)(),(0,r.iD)("div",{key:`cell-${o}`,class:"game-area__cell"},[(0,r._)("button",{type:"button",disabled:"computer"===(0,a.SU)(D)||e,ref_for:!0,ref:`cell-${t}-${o}`,onClick:e=>(0,a.SU)(_)&&(0,a.SU)(F)?U(t,o):P(t,o)},(0,l.zw)(e||"ㅤ"),9,M),(0,a.SU)(_)&&(0,a.SU)(F)?(0,r.wy)(((0,r.wg)(),(0,r.iD)("ul",k,[(0,r._)("li",{class:"game-area__item",onClick:e=>A({coords:{x:t,y:o},mover:"player"})}," player ",8,y),(0,r._)("li",{class:"game-area__item",onClick:e=>A({coords:{x:t,y:o},mover:"computer"})}," computer ",8,x)],512)),[[s.F8,(0,a.SU)(f)&&t===(0,a.SU)(w)&&o===(0,a.SU)(C)]]):(0,r.kq)("",!0)])))),128))],64)))),128))]),(0,a.SU)(_)?((0,r.wg)(),(0,r.iD)("section",b,[(0,r._)("button",{onClick:t[0]||(t[0]=e=>G())}," Выбор хода: "+(0,l.zw)((0,a.SU)(F)?"вкл":"выкл"),1),(0,r._)("button",{onClick:t[1]||(t[1]=e=>T())}," Сброс ")])):(0,r.kq)("",!0)]))}};const _=h;var f=_;const w={class:"game"};var C={__name:"GameView",setup(e){return(e,t)=>((0,r.wg)(),(0,r.iD)("div",w,[(0,r.Wm)(f)]))}};const F=C;var S=F}}]);
//# sourceMappingURL=999.7d1b13bd.js.map